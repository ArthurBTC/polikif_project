<!DOCTYPE html>
<html>
<head>

	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	
{% load staticfiles %}

	<link rel="stylesheet" type="text/css" href="{% static 'univok/style.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'univok/anim.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'gdpcore/joint.css' %}" />
<!--	<link rel="stylesheet" type="text/css" href="{% static 'gdpcore/nopadding.css' %}">	 -->
	<link rel="stylesheet" type="text/css" href="{% static 'gdpcore/css/bootstrap.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'gdpcore/jquery-ui-1.11/jquery-ui.min.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'gdpcore/animate.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'univok/css/open sans.css' %}">
	
	<script src="{% static 'gdpcore/jquery.min.js' %}"></script>
	<script src="{% static 'gdpcore/jquery-ui-1.11/jquery-ui.min.js' %}"></script>	
	<script src="{% static 'gdpcore/js/bootstrap.min.js' %}"></script>
	<script src="{% static 'gdpcore/lodash.min.js' %}"></script>
	<script src="{% static 'gdpcore/backbone-min.js' %}"></script>
	<script src="{% static 'gdpcore/joint.js' %}"></script>
	<script src="{% static 'gdpcore/googlecharts.js' %}"></script>
	

	<script src="https://cdn.rawgit.com/ariutta/svg-pan-zoom/master/dist/svg-pan-zoom.min.js"></script>	


</head>
<body>

<div id="topBar">
	<a href="{% url 'collectif' %}">Fruitay</div>
</div>

<div class="container">
	<div class="row topRow">
		<div class="col-md-3">
			<img id = "logo" src = "{% static 'gdpcore/ecossolies.png' %}" onclick="window.location='/univok/index/';"></img>
		</div>
		<div class="col-md-9 titleContainer">
			<span class = "title">{{event.name}}</span>
		</div>
	</div>
	
	<div class="row photosRow">
		<div class="col-md-12">
			<div class="row subtitleContainer">
		<div class = 'subtitle'>Photos</div>
	</div>

			<div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
<!-- Indicators -->
	  <ol class="carousel-indicators">
		<li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
		<li data-target="#carousel-example-generic" data-slide-to="1"></li>
		<li data-target="#carousel-example-generic" data-slide-to="2"></li>
	  </ol>

	  <!-- Wrapper for slides -->
	  <div class="carousel-inner" role="listbox">
		<div class="item active">
		  <img class = "carouselPicture" src="{% static 'univok/pic1.jpg' %}" alt="...">
		  <div class="carousel-caption">
			...
		  </div>
		</div>
		<div class="item">
		  <img class = "carouselPicture" src="{% static 'univok/pic2.jpg' %}" alt="...">
		  <div class="carousel-caption">
		  </div>
		</div>
		<div class="item">
		  <img class = "carouselPicture" src="{% static 'univok/pic3.jpg' %}" alt="...">
		  <div class="carousel-caption">
			...
		  </div>
		</div>
	  </div>

	  <!-- Controls -->
	  <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
		<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
		<span class="sr-only">Previous</span>
	  </a>
	  <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
		<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
		<span class="sr-only">Next</span>
	  </a>
	</div>
		</div>
	</div>
	
	
	<div class="row subtitleContainer">
		<div class = 'subtitle'>Synthèse</div>
	</div>
	<div class="row">
	<!--	<iframe src="/gdpcore/puretheater/4" width="1000" height="500"></iframe> -->
		<img id="starter" class="animPlay" src = "{% static 'univok/clickmeUnivok.png' %}" ></img>
	</div>
	<div class="row subtitleContainer">
		<div class = 'subtitle'>Intervenants</div>
	</div>	
	
	{% for speaker in event.speakers.all %}
		<div class="row">
			<div class="col-md-3">
				<img class = "speakerPicture" src = "/media/{{speaker.picture}}">
			</div>
			<div class="col-md-9">
				<div class = "speakerName">{{ speaker.name }}</div>
				<div class = "speakerDescription">{{ speaker.description }}</div>
			</div>
		</div>
	{% endfor %}

</div>

<img id="blackUnivok" class = "cta anim" src="{% static 'univok/blackUnivok.png' %}" alt="Play">

<div id="myholder" class = "anim"></div>
<img id="playAnim" class = "anim" src="{% static 'gdpcore/play.png' %}" alt="Play">
<img id="stopAnim" class = "anim" src="{% static 'gdpcore/stop.png' %}" alt="Pause">
<img id="closeCross" class = "anim" src="{% static 'gdpcore/closecross.png' %}" alt="Cancel">
{% include "gdpcore/showparts.html" %}

<div id="callToAction" class = "cta"></div>
<img id="ctaOk" class = "cta ctaImg" src="{% static 'gdpcore/ctaOk.png' %}" alt="Play">
<div id="ctaOkText" class = "cta ctaText">J'ai tout compris !</div>
<img id="ctaNok" class = "cta ctaImg" src="{% static 'gdpcore/ctaNok.png' %}" alt="Play">
<div id="ctaNokText" class = "cta ctaText">J'ai une question, une remarque...</div>
<img id="ctaAgain" class = "cta ctaImg" src="{% static 'gdpcore/ctaAgain.png' %}" alt="Play">
<div id="ctaAgainText" class = "cta ctaText">Relancer la vidéo</div>
<img id="ctaGraph" class = "cta ctaImg" src="{% static 'gdpcore/ctaGraph.png' %}" alt="Play">
<div id="ctaGraphText" class = "cta ctaText">Voir le graphe</div>

<div id="ctaMerci" class="cta2">Merci !</div>	

<img id="ctaQueAccurate" class = "ctaQue ctaQueImg" src="{% static 'gdpcore/ctaQueAccurate.png' %}">
<div id="ctaQueAccurateText" class = "ctaQue ctaQueText">J'ai une remarque/question sur un point précis de la vidéo</div>
<img id="ctaQueGeneral" class = "ctaQue ctaQueImg" src="{% static 'gdpcore/ctaQueGeneral.png' %}">
<div id="ctaQueGeneralText" class = "ctaQue ctaQueText">J'ai une question d'ordre général</div>
<img id="ctaQueBack" class = "ctaQue ctaQueImg" src="{% static 'gdpcore/ctaQueBack.png' %}">
<div id="ctaQueBackText" class = "ctaQue ctaQueText">Je n'ai plus de question en fait</div>


<div id="ctaQueAccurateInstruction" class="cta2">Selectionnez le(s) point(s) concernés, entrez votre question, puis appuyez sur la cible</div>
<div id="ctaQueAccurateContainer"></div>

<img id="ctaQueAccurateClick" class="cta2 ctaInput" src="{% static 'gdpcore/ctaQueAccurate.png' %}">
<textarea id="ctaQueAccurateInput" class="cta2 form-control ctaInput" rows="3" placeholder="Votre question"></textarea>
<textarea id="ctaQueAccurateSelection" class="cta2 form-control ctaInput" rows="3" placeholder="Votre question" disabled></textarea>

<div id="ctaForm" class="cta2" class="form-horizontal">
  
  <div class="form-group">
    <label for="inputEmail3" class="col-sm-2 control-label">Question</label>
    <div class="col-sm-10">
      <textarea class="form-control" rows="3" placeholder="Votre question"></textarea>
    </div>	
  </div>
  <div class="form-group">
    <label for="inputEmail3" class="col-sm-2 control-label">Email</label>
    <div class="col-sm-10">
      <input type="email" class="form-control" id="inputEmail3" placeholder="Email">
    </div>
  </div>
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button id="submitQuestion" class="btn btn-default">Sign in</button>
    </div>
  </div>
</div>


<script>

	$('.carousel').carousel({
		interval: false
	});

	{% include "gdpcore/grapher.js" %}

	var selectTime = 1200;
	var selectTimeNext = 2000;
	
	function selectHandlerAnim(type, elemId){
	
		$('.'+type+'Img').removeClass('animated bounceInLeft');
		$('.'+type+'Text').removeClass('animated bounceInRight');
	
		$('.'+type+'Img').not("#"+type+elemId).addClass('animated bounceOutLeft');
		$('.'+type+'Text').not("#"+type+elemId+"Text").addClass('animated bounceOutRight');
		
		setTimeout("$('#"+type+elemId+"').addClass('animated bounceOutLeft');",selectTime);
		setTimeout("$('#"+type+elemId+"Text').addClass('animated bounceOutRight');",selectTime);	
		
	}
	
	function initAnim(isItFirst){
		counter = 1;
		console.log('initAnim');
		unsetDrag();
		allCells = graph.getCells();
		allCells.forEach(function(entry) {
			paper.findViewByModel(entry).unhighlight();
			entry.attr('./display','none');
		});		
		
		$(".anim").show();
		$('.cta, .cta2').hide();
		$("#blackUnivok").show();
		$("#stopAnim").hide();
		
		$('#myholder').removeClass('animated bounceInLeft');
		$('#callToAction').removeClass('animated bounceOutRight');
		
		$('#callToAction').removeClass('fullscreen');		
		$('#myholder').addClass('fullscreen');

		console.log(isItFirst);
		
		if (isItFirst != false){		
			console.log('azeazeazeaz')
			$('#myholder').removeClass('animated bounceOutRight');
			$('#myholder').addClass('animated bounceInLeft');
		} 
		
		paper.setDimensions($('#myholder').width(), $('#myholder').height()); 	

		$("#playAnim").removeClass('animated bounceOutRight');	
		$("#playAnim").addClass('animated bounceInLeft');
		
		$( "body" ).one("click", "#playAnim", function(event) {
			$("#playAnim").removeClass('animated bounceInLeft');			
			$("#playAnim").addClass('animated bounceOutRight');	
			setTimeout(readshow,2000);
		});
		
		$( "body" ).one("click", "#closeCross", function(event) {
			stopshow();
			initCta();
		});		

	}
	
	function initCta(){
		console.log('initCta');		
		$(".anim, .cta2").hide();
		$(".cta").show();
		$("#blackUnivok").show();
		
		$('#myholder').removeClass('fullscreen');
		$('#callToAction').addClass('fullscreen');
		
		$('.ctaImg').removeClass('bounceOutLeft');
		$('.ctaText').removeClass('bounceOutRight');
		
		$('.ctaImg').addClass('animated bounceInLeft');
		$('.ctaText').addClass('animated bounceInRight');

		
		$( "body" ).one("click", "#ctaOk", function(event) {	
			selectHandlerAnim('cta','Ok');
			sayThanks('A bientôt, et merci !','green');
			setTimeout(
				"$('#callToAction').removeClass('animated bounceInLeft');"
				+"$('#callToAction').addClass('animated bounceOutRight');"
				,4000);
			setTimeout(initPage,5000)
			setTimeout(
				"$('#callToAction').show();"
				+"$('#starter').removeClass('animated bounceOutLeft');"
				+"$('#starter').addClass('animated bounceInRight');"
				,6000)
		});
		
		$( "body" ).one("click", "#ctaNok", function(event) {		
			selectHandlerAnim('cta','Nok');
			setTimeout(initCtaQuestion, selectTimeNext);							
		});
		
		$( "body" ).one("click", "#ctaAgain", function(event) {	
			selectHandlerAnim('cta','Again');
			setTimeout(function() {
				initAnim(false);
			}, selectTimeNext);
		});		

		$( "body" ).one("click", "#ctaGraph", function(event) {	
			selectHandlerAnim('cta','Graph');
			setTimeout(initGraph, selectTimeNext);
		});			
		
	}

	function initCtaQuestion(){
		
		console.log('initCtaQuestion');		
		$(".anim, cta2").hide();
		$(".ctaQue").show();
		$("#blackUnivok").show();
		
		$('#myholder').removeClass('fullscreen');
		$('#callToAction').addClass('fullscreen');
		
		$('.ctaQueImg').removeClass('bounceOutLeft');
		$('.ctaQueText').removeClass('bounceOutRight');
		
		$('.ctaQueImg').addClass('animated bounceInLeft');
		$('.ctaQueText').addClass('animated bounceInRight');

		
		$( "body" ).one("click", "#ctaQueAccurate", function(event) {
			selectHandlerAnim('ctaQue','Accurate');
			setTimeout(initGraph, selectTimeNext);
			setTimeout(initAccurate, selectTimeNext);
		});		

		$( "body" ).one("click", "#ctaQueGeneral", function(event) {	
			selectHandlerAnim('ctaQue','General');
			setTimeout(initGeneralForm, selectTimeNext);
		});	

		$( "body" ).one("click", "#ctaQueBack", function(event) {	
			selectHandlerAnim('ctaQue','Back');
			setTimeout(initCta, selectTimeNext);
		});	
		
	}	

	function initGeneralForm(){
	
		$('#ctaForm').removeClass('animated bounceOutRight');	
		$('#ctaForm').show();
		$('#ctaForm').addClass('animated bounceInLeft');
	}

	function initAccurate(){
		
		selectedCells = [];
		setPossibleSelection();
		setTimeout("$('#ctaQueAccurateInstruction').show();$('#ctaQueAccurateInstruction').addClass('animated bounceInUp');",1000);
		
		$( "body" ).one("click", "#ctaQueAccurateClick", function(event) {
		
//			$('#ctaQueAccurateInstruction').removeClass('animated bounceInUp');
//			$('#ctaQueAccurateInstruction').addClass('animated bounceOutDown');
//			initAccurateForm(selectedCells);

			sayThanks('Votre question a été enregistrée, merci', 'yellow');
			$("#ctaQueAccurateSelection,#ctaQueAccurateInput").val('');
//			initAccurate();
//			unsetPossibleSelection();
		
		});
	}
	
	function initAccurateForm(selectedCells){

		console.log('initAccurateForm');		
		$(".anim, cta2").hide();
		$(".cta").hide();
		$("#callToAction").show();
		$("#blackUnivok").show();
		
		$('#myholder').removeClass('fullscreen');
		$('#callToAction').addClass('fullscreen');

		console.log(selectedCells);
		selectedCells.forEach(function(entry) {
		
			cell = graph.getCell(entry)
			stri = 
			"<div class = 'accurateText'>"+cell.get('autorname')+' '+cell.get('text')+'</div>'
			+"<textarea class='form-control' rows='3' placeholder='Votre remarque...'></textarea>"
			
			$("#ctaQueAccurateContainer").append(stri);
		});	
		
	
	}
	
	function initPage(){
		
		$('#myholder').removeClass('animated bounceInLeft');
		$('#callToAction').removeClass('animated bounceOutRight');		
		$('.anim, .cta, .cta2, .ctaQue, #blackUnivok').hide();
		$('#myholder').removeClass('fullscreen');
		$('#callToAction').removeClass('fullscreen');
		
		$( "body" ).one("click", '#starter', function(event) {
			$("#starter").removeClass('animated bounceInRight');
			$("#starter").addClass('animated bounceOutLeft');
			setTimeout(function() {
				initAnim(true);
			},1500);
		});	
	}
	
	function sayThanks(text, color){
		$('#ctaMerci').text(text);
		$('#ctaMerci').css('color',color);
		
		$('#ctaMerci').removeClass('animated bounceOutRight');
		
		setTimeout("$('#ctaMerci').show();$('#ctaMerci').addClass('animated bounceInLeft');", 1000);
		setTimeout("$('#ctaMerci').addClass('animated bounceOutRight');", 4000);
//		setTimeout(initPage, 4000);	
	}

	function initGraph(){
		console.log('initGraph');
		
		setDrag();
		unsetPossibleSelection();
		allCells = graph.getCells();
		allCells.forEach(function(entry) {
			paper.findViewByModel(entry).unhighlight();
			entry.attr('./display','');
		});		

		$(".anim").show();		
		$('.cta, .cta2').hide();
		$("#blackUnivok").show();
		$("#stopAnim,#playAnim").hide();		

		$('#myholder').removeClass('animated bounceInLeft');
		$('#callToAction').removeClass('animated bounceOutRight');		
		
		$('#callToAction').removeClass('fullscreen');		
		$('#myholder').addClass('fullscreen');	
		paper.setDimensions($('#myholder').width(), $('#myholder').height());
		
		$(window).resize(function(){	
			paper.setDimensions($('#myholder').width(), $('#myholder').height());
		}) 		
		//setGridZoom(paper, 'myholder', 0);
		$( "body" ).one("click", "#closeCross", function(event) {	
			initCta();
		});
		
	}
	
	$( document ).ready(function() {
		paper = addPaper('myholder');
		firstLoadFromShowparts('myholder');
		initPage();
					
		$( "body" ).on("click", "#stopAnim", function(event) {		
			stopshow();
		});
		
		$( "body" ).on("click", "#submitQuestion", function(event) {		
	
			$('#ctaForm').removeClass('animated bounceInLeft');
			$('#ctaForm').addClass('animated bounceOutRight');
			sayThanks('Votre demande a été prise en compte. Merci !','yellow');
			setTimeout(initCta, 5000);
				
		});
		
		function starterShake(){
		
			console.log('shaker');
	//		$("#starter").removeClass('animated bounce');
			
			$('#starter').addClass('animated infinite shake');
			$("#starter").removeClass('animated infinite shake');	
			setTimeout(starterShake,3000)
		}

	
			
	});


</script>

</body>
</html>






